/**
 * Header Component Templates
 * –®–∞–±–ª–æ–Ω—ã –¥–ª—è –≤–µ—Ä—Ö–Ω–µ–π –ø–∞–Ω–µ–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
 */

export const HeaderTemplate = {
  /**
   * –û—Å–Ω–æ–≤–Ω–æ–π —à–∞–±–ª–æ–Ω –≤–µ—Ä—Ö–Ω–µ–π –ø–∞–Ω–µ–ª–∏
   */
  render(state) {
    const { user, theme, language, currency } = state;
    
    return `
      <header class="app-header" id="app-header">
        <div class="header-container">
          <!-- –õ–µ–≤–∞—è —á–∞—Å—Ç—å: –õ–æ–≥–æ—Ç–∏–ø –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ -->
          <div class="header-left">
            <div class="header-logo">
              <img src="./assets/images/logo.png" alt="ORDINA" class="logo-image">
              <span class="logo-text">ORDINA</span>
            </div>
          </div>

          <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å: –í–∏–¥–∂–µ—Ç –ø–æ–≥–æ–¥—ã -->
          <div class="header-center">
            <div id="header-weather-widget"></div>
          </div>

          <!-- –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –ø—Ä–æ—Ñ–∏–ª—å -->
          <div class="header-right">
            <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã -->
            <button class="header-btn theme-toggle" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É" data-action="toggle-theme">
              <i class="fas ${theme === 'dark' ? 'fa-sun' : 'fa-moon'}"></i>
            </button>

            <!-- –í—ã–±–æ—Ä —è–∑—ã–∫–∞ -->
            <div class="header-dropdown language-selector">
              <button class="header-btn dropdown-toggle" data-dropdown="language">
                <i class="fas fa-language"></i>
                <span class="dropdown-label">${language.toUpperCase()}</span>
                <i class="fas fa-chevron-down dropdown-arrow"></i>
              </button>
              <div class="dropdown-menu" data-menu="language">
                <button class="dropdown-item ${language === 'ru' ? 'active' : ''}" data-lang="ru">
                  <span class="flag-icon">üá∑üá∫</span> –†—É—Å—Å–∫–∏–π
                </button>
                <button class="dropdown-item ${language === 'en' ? 'active' : ''}" data-lang="en">
                  <span class="flag-icon">üá¨üáß</span> English
                </button>
                <button class="dropdown-item ${language === 'az' ? 'active' : ''}" data-lang="az">
                  <span class="flag-icon">üá¶üáø</span> Az…ôrbaycan
                </button>
              </div>
            </div>

            <!-- –í—ã–±–æ—Ä –≤–∞–ª—é—Ç—ã -->
            <div class="header-dropdown currency-selector">
              <button class="header-btn dropdown-toggle" data-dropdown="currency">
                <i class="fas fa-dollar-sign"></i>
                <span class="dropdown-label">${currency}</span>
                <i class="fas fa-chevron-down dropdown-arrow"></i>
              </button>
              <div class="dropdown-menu" data-menu="currency">
                <button class="dropdown-item ${currency === 'AZN' ? 'active' : ''}" data-currency="AZN">
                  ‚Çº AZN
                </button>
                <button class="dropdown-item ${currency === 'USD' ? 'active' : ''}" data-currency="USD">
                  $ USD
                </button>
              </div>
            </div>

            <!-- –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
            ${user ? this.renderUserMenu(user) : this.renderAuthButton()}

            <!-- –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é -->
            <button class="header-btn mobile-menu-toggle" data-action="toggle-mobile-menu">
              <i class="fas fa-bars"></i>
            </button>
          </div>
        </div>

        <!-- –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é -->
        <div class="mobile-menu" id="mobile-menu">
          <div class="mobile-menu-content">
            ${this.renderMobileMenu(state)}
          </div>
        </div>
      </header>
    `;
  },

  /**
   * –ú–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   */
  renderUserMenu(user) {
    return `
      <div class="header-dropdown user-menu">
        <button class="header-btn dropdown-toggle user-avatar" data-dropdown="user">
          ${user.photoURL 
            ? `<img src="${user.photoURL}" alt="${user.displayName || user.email}" class="avatar-image">` 
            : `<i class="fas fa-user-circle"></i>`
          }
          <i class="fas fa-chevron-down dropdown-arrow"></i>
        </button>
        <div class="dropdown-menu dropdown-menu-right" data-menu="user">
          <div class="dropdown-header">
            <div class="user-info">
              <div class="user-name">${user.displayName || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'}</div>
              <div class="user-email">${user.email}</div>
            </div>
          </div>
          <div class="dropdown-divider"></div>
          <button class="dropdown-item" data-action="profile">
            <i class="fas fa-user"></i> –ü—Ä–æ—Ñ–∏–ª—å
          </button>
          <button class="dropdown-item" data-action="settings">
            <i class="fas fa-cog"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
          </button>
          <div class="dropdown-divider"></div>
          <button class="dropdown-item" data-action="logout">
            <i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏
          </button>
        </div>
      </div>
    `;
  },

  /**
   * –ö–Ω–æ–ø–∫–∞ –≤—Ö–æ–¥–∞
   */
  renderAuthButton() {
    return `
      <button class="header-btn btn-primary" data-action="login">
        <i class="fas fa-sign-in-alt"></i>
        <span class="btn-text">–í–æ–π—Ç–∏</span>
      </button>
    `;
  },

  /**
   * –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é
   */
  renderMobileMenu(state) {
    const { user, theme, language, currency } = state;
    
    return `
      <div class="mobile-menu-header">
        <h3>–ú–µ–Ω—é</h3>
        <button class="mobile-menu-close" data-action="close-mobile-menu">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="mobile-menu-section">
        <h4>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h4>
        
        <div class="mobile-menu-item">
          <span class="mobile-menu-label">
            <i class="fas fa-moon"></i> –¢–µ–º–∞
          </span>
          <button class="mobile-toggle-btn" data-action="toggle-theme">
            ${theme === 'dark' ? '–¢–µ–º–Ω–∞—è' : '–°–≤–µ—Ç–ª–∞—è'}
          </button>
        </div>

        <div class="mobile-menu-item">
          <span class="mobile-menu-label">
            <i class="fas fa-language"></i> –Ø–∑—ã–∫
          </span>
          <select class="mobile-select" data-select="language">
            <option value="ru" ${language === 'ru' ? 'selected' : ''}>–†—É—Å—Å–∫–∏–π</option>
            <option value="en" ${language === 'en' ? 'selected' : ''}>English</option>
            <option value="az" ${language === 'az' ? 'selected' : ''}>Az…ôrbaycan</option>
          </select>
        </div>

        <div class="mobile-menu-item">
          <span class="mobile-menu-label">
            <i class="fas fa-dollar-sign"></i> –í–∞–ª—é—Ç–∞
          </span>
          <select class="mobile-select" data-select="currency">
            <option value="AZN" ${currency === 'AZN' ? 'selected' : ''}>AZN (‚Çº)</option>
            <option value="USD" ${currency === 'USD' ? 'selected' : ''}>USD ($)</option>
          </select>
        </div>
      </div>

      ${user ? `
        <div class="mobile-menu-section">
          <h4>–ü—Ä–æ—Ñ–∏–ª—å</h4>
          <div class="mobile-user-info">
            ${user.photoURL 
              ? `<img src="${user.photoURL}" alt="${user.displayName || user.email}" class="mobile-avatar">` 
              : `<i class="fas fa-user-circle mobile-avatar-icon"></i>`
            }
            <div class="mobile-user-details">
              <div class="mobile-user-name">${user.displayName || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'}</div>
              <div class="mobile-user-email">${user.email}</div>
            </div>
          </div>
          <button class="mobile-menu-btn" data-action="logout">
            <i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏
          </button>
        </div>
      ` : `
        <div class="mobile-menu-section">
          <button class="mobile-menu-btn btn-primary" data-action="login">
            <i class="fas fa-sign-in-alt"></i> –í–æ–π—Ç–∏
          </button>
        </div>
      `}
    `;
  }
};
