/**
 * Accessibility Styles
 * 
 * Ensures WCAG AA compliance for focus indicators, color contrast, and touch targets.
 * Requirements: 14.1, 14.2, 14.3, 14.4, 14.5
 */

/* ===== Focus Indicators (Requirement 14.3) ===== */

/* Ensure all focusable elements have visible focus indicators */
*:focus {
  outline: 2px solid currentColor;
  outline-offset: 2px;
}

/* Enhanced focus for interactive elements */
button:focus,
a:focus,
input:focus,
select:focus,
textarea:focus,
[role="button"]:focus,
[role="link"]:focus,
[tabindex]:not([tabindex="-1"]):focus {
  outline: 2px solid #667eea;
  outline-offset: 2px;
  box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.2);
}

/* Dark mode focus indicators */
.dark button:focus,
.dark a:focus,
.dark input:focus,
.dark select:focus,
.dark textarea:focus,
.dark [role="button"]:focus,
.dark [role="link"]:focus,
.dark [tabindex]:not([tabindex="-1"]):focus {
  outline-color: #fbbf24;
  box-shadow: 0 0 0 4px rgba(251, 191, 36, 0.2);
}

/* Remove default focus outline for mouse users, keep for keyboard users */
*:focus:not(:focus-visible) {
  outline: none;
  box-shadow: none;
}

*:focus-visible {
  outline: 2px solid #667eea;
  outline-offset: 2px;
  box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.2);
}

.dark *:focus-visible {
  outline-color: #fbbf24;
  box-shadow: 0 0 0 4px rgba(251, 191, 36, 0.2);
}

/* ===== Touch Targets (Requirement 14.2) ===== */

/* Ensure minimum 44x44px touch targets on mobile */
@media (max-width: 768px) {
  button,
  a,
  input[type="button"],
  input[type="submit"],
  input[type="reset"],
  [role="button"],
  [role="link"] {
    min-width: 44px;
    min-height: 44px;
    padding: 0.75rem;
  }

  /* Exception for inline links in text */
  p a,
  span a,
  li a {
    min-width: auto;
    min-height: auto;
    padding: 0.25rem;
  }
}

/* ===== Screen Reader Only Content (Requirement 14.4) ===== */

/* Visually hidden but accessible to screen readers */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

/* Focusable screen reader only content */
.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  padding: inherit;
  margin: inherit;
  overflow: visible;
  clip: auto;
  white-space: normal;
}

/* ===== Color Contrast (Requirement 14.5) ===== */

/* Ensure sufficient contrast for text */
body {
  color: #1f2937; /* Dark gray on light background: 16:1 ratio */
  background-color: #ffffff;
}

.dark body {
  color: #f9fafb; /* Light gray on dark background: 15:1 ratio */
  background-color: #111827;
}

/* Link colors with sufficient contrast */
a {
  color: #2563eb; /* Blue with 4.5:1 contrast on white */
  text-decoration: underline; /* Not relying on color alone */
}

a:hover {
  color: #1d4ed8; /* Darker blue on hover */
  text-decoration: underline;
}

.dark a {
  color: #60a5fa; /* Light blue with 4.5:1 contrast on dark */
}

.dark a:hover {
  color: #93c5fd; /* Lighter blue on hover */
}

/* Error states - not relying on color alone */
.error,
[aria-invalid="true"] {
  border-color: #dc2626 !important;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23dc2626' viewBox='0 0 16 16'%3E%3Cpath d='M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z'/%3E%3Cpath d='M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 0.5rem center;
  background-size: 1rem;
  padding-right: 2.5rem;
}

/* Success states - not relying on color alone */
.success,
[aria-invalid="false"] {
  border-color: #16a34a !important;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%2316a34a' viewBox='0 0 16 16'%3E%3Cpath d='M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 0.5rem center;
  background-size: 1rem;
  padding-right: 2.5rem;
}

/* Warning states - not relying on color alone */
.warning {
  border-color: #f59e0b !important;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23f59e0b' viewBox='0 0 16 16'%3E%3Cpath d='M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 0.5rem center;
  background-size: 1rem;
  padding-right: 2.5rem;
}

/* ===== Keyboard Navigation Indicators (Requirement 14.2) ===== */

/* Show keyboard navigation mode */
body.keyboard-navigation *:focus {
  outline: 3px solid #667eea;
  outline-offset: 3px;
}

.dark body.keyboard-navigation *:focus {
  outline-color: #fbbf24;
}

/* ===== Reduced Motion (Accessibility Preference) ===== */

/* Respect user's motion preferences */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* ===== High Contrast Mode Support ===== */

@media (prefers-contrast: high) {
  button,
  a,
  input,
  select,
  textarea {
    border: 2px solid currentColor;
  }

  *:focus {
    outline-width: 3px;
  }
}

/* ===== ARIA Live Regions (Requirement 14.4) ===== */

/* Style for live regions */
[aria-live="polite"],
[aria-live="assertive"] {
  position: relative;
}

/* Ensure live regions are announced but not visually intrusive */
[role="status"],
[role="alert"] {
  padding: 0.75rem 1rem;
  border-radius: 0.375rem;
  margin: 0.5rem 0;
}

[role="alert"] {
  background-color: #fef2f2;
  border: 1px solid #fecaca;
  color: #991b1b;
}

.dark [role="alert"] {
  background-color: #7f1d1d;
  border-color: #991b1b;
  color: #fecaca;
}

[role="status"] {
  background-color: #eff6ff;
  border: 1px solid #bfdbfe;
  color: #1e40af;
}

.dark [role="status"] {
  background-color: #1e3a8a;
  border-color: #1e40af;
  color: #bfdbfe;
}
